USE MASTER
DROP DATABASE ESPORTS
GO

IF DB_ID('ESPORTS') IS NOT NULL
BEGIN
    ALTER DATABASE ESPORTS
    SET SINGLE_USER
    WITH ROLLBACK IMMEDIATE
   
    DROP DATABASE ESPORTS
END

CREATE DATABASE ESPORTS
GO

USE ESPORTS
GO

CREATE TABLE CLUB (
	IDCLUB NVARCHAR(10) PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(50) NOT NULL
	)
GO

INSERT INTO CLUB (IDCLUB, NOMBRE) VALUES
	('G2', 'G2 ESPORTS'), 
	('FNC', 'FNATIC')
GO

CREATE TABLE AFILIADOS(
	IDAFILIADO int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(25) NOT NULL,
	FECHAAF nvarchar(25) NOT NULL,
	IDCLUB NVARCHAR(10) REFERENCES CLUB (IDCLUB)
	)
GO

INSERT INTO AFILIADOS (IDAFILIADO, NOMBRE, FECHAAF, IDCLUB) VALUES
	(1, 'Donovan', '10/10/2019', 'G2'), 
	(2, 'xPeke', '17/08/2018', 'FNC')
GO


CREATE TABLE PATROCINIOS(
	IDPATROCINIO int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(25) NOT NULL,
	PAGO MONEY NOT NULL,
	IDCLUB NVARCHAR(10) REFERENCES CLUB(IDCLUB)
	)
GO

INSERT INTO PATROCINIOS (IDPATROCINIO, NOMBRE, PAGO, IDCLUB) VALUES
	(1, 'REDBULL', 2000, 'G2'), 
	(2, 'BMW', 2500, 'G2'),
	(3, 'LOGITECH', 1950, 'FNC')
GO


CREATE TABLE TROFEOS(
	IDTROFEO int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(50) NOT NULL,
	JUEGO nvarchar(50) NOT NULL,
	IDCLUB NVARCHAR(10) REFERENCES CLUB(IDCLUB)
	)
GO

INSERT INTO TROFEOS (IDTROFEO, NOMBRE, JUEGO, IDCLUB) VALUES
	(1, 'WORLD CHAMPION', 'LEAGUE OF LEGENDS', 'G2'), 
	(2, 'EUROPE CHAMPION', 'RAINBOW SIX SIEGE', 'G2'),
	(3, 'SPANISH CHAMPION', 'WORLD OF WARCRAFT', 'FNC')
GO

CREATE TABLE PROYECTOS(
	IDPROYECTO int PRIMARY KEY NOT NULL,
	DESCRIPCION nvarchar(200) NOT NULL,
	IDCLUB NVARCHAR(10) REFERENCES CLUB(IDCLUB)
	)
GO

INSERT INTO PROYECTOS (IDPROYECTO, DESCRIPCION, IDCLUB) VALUES
	(1, 'Contratar nuevos jugadores', 'G2'), 
	(2, 'Contratar nuevos entrenadores', 'FNC')
GO


CREATE TABLE ENTRENADORES(
	IDENTRENADOR int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(25) NOT NULL,
	SALARIO MONEY NOT NULL,
	IDCLUB NVARCHAR(10) REFERENCES CLUB(IDCLUB)
	)
GO

INSERT INTO ENTRENADORES (IDENTRENADOR, NOMBRE, SALARIO, IDCLUB) VALUES
	(1, 'Alan', 1300, 'G2'), 
	(2, 'Ernesto', 1150, 'FNC')
GO


CREATE TABLE JUGADORES(
	IDJUGADOR int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(25) NOT NULL,
	SALARIO MONEY NOT NULL
	)
GO

INSERT INTO JUGADORES (IDJUGADOR, NOMBRE, SALARIO) VALUES
	(1, 'Iker', 2000), 
	(2, 'Antonio', 2300),
	(3, 'Jose', 1850),
	(4, 'Mikel', 1850)
GO


CREATE TABLE ENTRENA(
	IDENTRENADOR int REFERENCES ENTRENADORES (IDENTRENADOR) NOT NULL,
	IDJUGADOR INT REFERENCES JUGADORES (IDJUGADOR) NOT NULL,
	PRIMARY KEY (IDENTRENADOR, IDJUGADOR)
	)
GO

INSERT INTO ENTRENA (IDENTRENADOR, IDJUGADOR) VALUES
	(1, 1), 
	(1, 2),
	(2, 3)
GO

CREATE TABLE COMPETICIONES(
	IDCOMPETICION int PRIMARY KEY NOT NULL,
	NOMBRE nvarchar(25) NOT NULL,
	FECHA NVARCHAR(25) NOT NULL,
	JUEGO NVARCHAR(25) NOT NULL
	)
GO

INSERT INTO COMPETICIONES (IDCOMPETICION, NOMBRE, FECHA, JUEGO) VALUES
	(1, 'WORLD CHAMPIONSHIP', '10/10/2017', 'LEAGUE OF LEGENDS'), 
	(2, 'EUROPE CHAMPIONSHIP', '02/05/2019', 'RAINBOW SIX SIEGE'),
	(3, 'SPANISH CHAMPIONSHIP', '17/03/2018', 'WORLD OF WARCRAFT')
GO


CREATE TABLE COMPETIR(
	IDJUGADOR int REFERENCES JUGADORES (IDJUGADOR) NOT NULL,
	IDCOMPETICION INT REFERENCES COMPETICIONES (IDCOMPETICION) NOT NULL,
	PRIMARY KEY (IDJUGADOR, IDCOMPETICION)
	)
GO

INSERT INTO COMPETIR (IDJUGADOR, IDCOMPETICION) VALUES
	(1, 1), 
	(2, 1),
	(3, 2),
	(4, 3)
GO

------------------------------------------------------------------- Clubes
-- LISTAR
IF OBJECT_ID('SP_listarClubes') IS NOT NULL
	BEGIN
		DROP PROC SP_listarClubes
	END
GO

CREATE PROC SP_listarClubes
as
BEGIN
	SELECT IDCLUB AS ID
	,NOMBRE
	FROM CLUB
END
GO
-- CREAR
IF OBJECT_ID('SP_crearClub') IS NOT NULL
	BEGIN
		DROP PROC SP_crearClub
	END
GO

CREATE PROC SP_crearClub
@IDCLUB NVARCHAR(10),
@NOMBRE NVARCHAR(50)
as
BEGIN
	INSERT INTO CLUB([IDCLUB]
	,[NOMBRE])
	VALUES(@IDCLUB, @NOMBRE)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarClub') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarClub
	END
GO

CREATE PROC SP_modificarClub
@IDCLUB NVARCHAR(10),
@NOMBRE NVARCHAR(50)
as
BEGIN
	UPDATE CLUB
	SET [NOMBRE] = @NOMBRE
	WHERE [IDCLUB] = @IDCLUB
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarClub') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarClub
	END
GO

CREATE PROC SP_borrarClub
@IDCLUB NVARCHAR(10)
as
BEGIN
	DELETE FROM CLUB WHERE IDCLUB = @IDCLUB
END
GO

------------------------------------------------------------------- AFILIADOS
-- LISTAR
IF OBJECT_ID('SP_listarAfiliados') IS NOT NULL
	BEGIN
		DROP PROC SP_listarAfiliados
	END
GO

CREATE PROC SP_listarAfiliados
as
BEGIN
	SELECT IDAFILIADO AS ID
	,IDCLUB AS CLUB
	,NOMBRE
	,FECHAAF
	FROM AFILIADOS
END
GO

-- CREAR
IF OBJECT_ID('SP_crearAfiliado') IS NOT NULL
	BEGIN
		DROP PROC SP_crearAfiliado
	END
GO

CREATE PROC SP_crearAfiliado
@IDAFILIADO INT,
@NOMBRE NVARCHAR(25),
@FECHAAF NVARCHAR(25),
@IDCLUB NVARCHAR(10)
as
BEGIN
	INSERT INTO AFILIADOS([IDAFILIADO]
	,[NOMBRE], [FECHAAF], [IDCLUB])
	VALUES(@IDAFILIADO, @NOMBRE, @FECHAAF, @IDCLUB)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarAfiliado') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarAfiliado
	END
GO

CREATE PROC SP_modificarAfiliado
@IDAFILIADO INT,
@NOMBRE NVARCHAR(25),
@FECHAAF NVARCHAR(25),
@IDCLUB NVARCHAR(10)
as
BEGIN
	UPDATE AFILIADOS
	SET [NOMBRE] = @NOMBRE, [FECHAAF] = @FECHAAF, [IDCLUB] = @IDCLUB
	WHERE [IDAFILIADO] = @IDAFILIADO
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarAfiliado') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarAfiliado
	END
GO

CREATE PROC SP_borrarAfiliado
@IDAFILIADO INT
as
BEGIN
	DELETE FROM AFILIADOS WHERE IDAFILIADO = @IDAFILIADO
END
GO

------------------------------------------------------------------- PATROCINIOS
-- LISTAR
IF OBJECT_ID('SP_listarPatrocinios') IS NOT NULL
	BEGIN
		DROP PROC SP_listarPatrocinios
	END
GO

CREATE PROC SP_listarPatrocinios
as
BEGIN
	SELECT IDPATROCINIO AS ID
	,NOMBRE
	,PAGO
	,IDCLUB AS CLUB
	FROM PATROCINIOS
END
GO

-- CREAR
IF OBJECT_ID('SP_crearPatrocinio') IS NOT NULL
	BEGIN
		DROP PROC SP_crearPatrocinio
	END
GO

CREATE PROC SP_crearPatrocinio
@IDPATROCINIO INT,
@NOMBRE NVARCHAR(25),
@PAGO MONEY,
@IDCLUB NVARCHAR(10)
as
BEGIN
	INSERT INTO PATROCINIOS([IDPATROCINIO]
	,[NOMBRE], [PAGO], [IDCLUB])
	VALUES(@IDPATROCINIO, @NOMBRE, @PAGO, @IDCLUB)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarPatrocinio') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarPatrocinio
	END
GO

CREATE PROC SP_modificarPatrocinio
@IDPATROCINIO INT,
@NOMBRE NVARCHAR(25),
@PAGO MONEY,
@IDCLUB NVARCHAR(10)
as
BEGIN
	UPDATE PATROCINIOS
	SET [NOMBRE] = @NOMBRE, [PAGO] = @PAGO, [IDCLUB] = @IDCLUB
	WHERE [IDPATROCINIO] = @IDPATROCINIO
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarPatrocinio') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarPatrocinio
	END
GO

CREATE PROC SP_borrarPatrocinio
@IDPATROCINIO INT
as
BEGIN
	DELETE FROM PATROCINIOS WHERE IDPATROCINIO = @IDPATROCINIO
END
GO
EXEC SP_borrarPatrocinio @IDPATROCINIO = 4; 
------------------------------------------------------------------- TROFEOS
-- LISTAR
IF OBJECT_ID('SP_listarTrofeos') IS NOT NULL
	BEGIN
		DROP PROC SP_listarTrofeos
	END
GO

CREATE PROC SP_listarTrofeos
as
BEGIN
	SELECT IDTROFEO AS ID
	,NOMBRE
	,JUEGO
	,IDCLUB AS CLUB
	FROM TROFEOS
END
GO

-- CREAR
IF OBJECT_ID('SP_crearTrofeo') IS NOT NULL
	BEGIN
		DROP PROC SP_crearTrofeo
	END
GO

CREATE PROC SP_crearTrofeo
@IDTROFEO INT,
@NOMBRE NVARCHAR(25),
@JUEGO NVARCHAR(50),
@IDCLUB NVARCHAR(10)
as
BEGIN
	INSERT INTO TROFEOS([IDTROFEO]
	,[NOMBRE], [JUEGO], [IDCLUB])
	VALUES(@IDTROFEO, @NOMBRE, @JUEGO, @IDCLUB)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarTrofeo') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarTrofeo
	END
GO

CREATE PROC SP_modificarTrofeo
@IDTROFEO INT,
@NOMBRE NVARCHAR(25),
@JUEGO NVARCHAR(50),
@IDCLUB NVARCHAR(10)
as
BEGIN
	UPDATE TROFEOS
	SET [NOMBRE] = @NOMBRE, [JUEGO] = @JUEGO, [IDCLUB] = @IDCLUB
	WHERE [IDTROFEO] = @IDTROFEO
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarTrofeo') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarTrofeo
	END
GO

CREATE PROC SP_borrarTrofeo
@IDTROFEO INT
as
BEGIN
	DELETE FROM TROFEOS WHERE IDTROFEO = @IDTROFEO
END
GO

------------------------------------------------------------------- PROYECTOS
-- LISTAR
IF OBJECT_ID('SP_listarProyectos') IS NOT NULL
	BEGIN
		DROP PROC SP_listarProyectos
	END
GO

CREATE PROC SP_listarProyectos
as
BEGIN
	SELECT IDPROYECTO AS ID
	,DESCRIPCION
	,IDCLUB AS CLUB
	FROM PROYECTOS
END
GO

-- CREAR
IF OBJECT_ID('SP_crearProyecto') IS NOT NULL
	BEGIN
		DROP PROC SP_crearProyecto
	END
GO

CREATE PROC SP_crearProyecto
@IDPROYECTO INT,
@DESCRIPCION NVARCHAR(200),
@IDCLUB NVARCHAR(10)
as
BEGIN
	INSERT INTO PROYECTOS([IDPROYECTO]
	,[DESCRIPCION], [IDCLUB])
	VALUES(@IDPROYECTO, @DESCRIPCION, @IDCLUB)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarProyecto') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarProyecto
	END
GO

CREATE PROC SP_modificarProyecto
@IDPROYECTO INT,
@DESCRIPCION NVARCHAR(200),
@IDCLUB NVARCHAR(10)
as
BEGIN
	UPDATE PROYECTOS
	SET [DESCRIPCION] = @DESCRIPCION, [IDCLUB] = @IDCLUB
	WHERE [IDPROYECTO] = @IDPROYECTO
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarProyecto') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarProyecto
	END
GO

CREATE PROC SP_borrarProyecto
@IDPROYECTO INT
as
BEGIN
	DELETE FROM PROYECTOS WHERE IDPROYECTO = @IDPROYECTO
END
GO

------------------------------------------------------------------- ENTRENADORES
-- LISTAR
IF OBJECT_ID('SP_listarEntrenadores') IS NOT NULL
	BEGIN
		DROP PROC SP_listarEntrenadores
	END
GO

CREATE PROC SP_listarEntrenadores
as
BEGIN
	SELECT IDENTRENADOR AS ID
	,NOMBRE
	,SALARIO
	,IDCLUB AS CLUB
	FROM ENTRENADORES
END
GO

-- CREAR
IF OBJECT_ID('SP_crearEntrenador') IS NOT NULL
	BEGIN
		DROP PROC SP_crearEntrenador
	END
GO

CREATE PROC SP_crearEntrenador
@IDENTRENADOR INT,
@NOMBRE NVARCHAR(25),
@SALARIO MONEY,
@IDCLUB NVARCHAR(10)
as
BEGIN
	INSERT INTO ENTRENADORES([IDENTRENADOR]
	,[NOMBRE], [SALARIO], [IDCLUB])
	VALUES(@IDENTRENADOR, @NOMBRE, @SALARIO, @IDCLUB)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarEntrenador') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarEntrenador
	END
GO

CREATE PROC SP_modificarEntrenador
@IDENTRENADOR INT,
@NOMBRE NVARCHAR(25),
@SALARIO MONEY,
@IDCLUB NVARCHAR(10)
as
BEGIN
	UPDATE ENTRENADORES
	SET [NOMBRE] = @NOMBRE, [SALARIO] = @SALARIO, [IDCLUB] = @IDCLUB
	WHERE [IDENTRENADOR] = @IDENTRENADOR
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarEntrenador') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarEntrenador
	END
GO

CREATE PROC SP_borrarEntrenador
@IDENTRENADOR INT
as
BEGIN
	DELETE FROM ENTRENADORES WHERE IDENTRENADOR = @IDENTRENADOR
END
GO

-------------------------------------------------------------- ENTRENA
-- VER ENTRENAMIENTOS
IF OBJECT_ID('SP_listarEntrenamientos') IS NOT NULL
	BEGIN
		DROP PROC SP_listarEntrenamientos
	END
GO

CREATE PROC SP_listarEntrenamientos
as
BEGIN
	SELECT EN.NOMBRE AS ENTRENADOR, J.NOMBRE AS JUGADOR
	FROM ENTRENA E, JUGADORES J, ENTRENADORES EN
	WHERE E.IDENTRENADOR = EN.IDENTRENADOR AND E.IDJUGADOR = J.IDJUGADOR
	ORDER BY EN.NOMBRE
END
GO
-- ASIGNAR ENTRENADOR
IF OBJECT_ID('SP_crearEntrenamiento') IS NOT NULL
	BEGIN
		DROP PROC SP_crearEntrenamiento
	END
GO

CREATE PROC SP_crearEntrenamiento
@IDENTRENADOR INT,
@IDJUGADOR INT
as
BEGIN
	INSERT INTO ENTRENA([IDENTRENADOR], [IDJUGADOR])
	VALUES(@IDENTRENADOR, @IDJUGADOR)
END
GO

------------------------------------------------------------------- JUGADORES
-- LISTAR
IF OBJECT_ID('SP_listarJugadores') IS NOT NULL
	BEGIN
		DROP PROC SP_listarJugadores
	END
GO

CREATE PROC SP_listarJugadores
as
BEGIN
	SELECT IDJUGADOR AS ID
	,NOMBRE
	,SALARIO
	FROM JUGADORES
END
GO

-- CREAR
IF OBJECT_ID('SP_crearJugador') IS NOT NULL
	BEGIN
		DROP PROC SP_crearJugador
	END
GO

CREATE PROC SP_crearJugador
@IDJUGADOR INT,
@NOMBRE NVARCHAR(25),
@SALARIO MONEY
as
BEGIN
	INSERT INTO JUGADORES([IDJUGADOR]
	,[NOMBRE], [SALARIO])
	VALUES(@IDJUGADOR, @NOMBRE, @SALARIO)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarJugador') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarJugador
	END
GO

CREATE PROC SP_modificarJugador
@IDJUGADOR INT,
@NOMBRE NVARCHAR(25),
@SALARIO MONEY
as
BEGIN
	UPDATE JUGADORES
	SET [NOMBRE] = @NOMBRE, [SALARIO] = @SALARIO
	WHERE [IDJUGADOR] = @IDJUGADOR
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarJugador') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarJugador
	END
GO

CREATE PROC SP_borrarJugador
@IDJUGADOR INT
as
BEGIN
	DELETE FROM JUGADORES WHERE IDJUGADOR = @IDJUGADOR
END
GO

-------------------------------------------------------------- COMPETIR
-- VER COMPETICIONES
IF OBJECT_ID('SP_listarCompetir') IS NOT NULL
	BEGIN
		DROP PROC SP_listarCompetir
	END
GO

CREATE PROC SP_listarCompetir
as
BEGIN
	SELECT DISTINCT J.NOMBRE AS JUGADOR,
	COM.NOMBRE AS COMPETICIÓN
	FROM COMPETIR C, JUGADORES J, COMPETICIONES COM
	WHERE C.IDCOMPETICION = COM.IDCOMPETICION AND C.IDJUGADOR = J.IDJUGADOR
	ORDER BY J.NOMBRE
END
GO
-- ASIGNAR ENTRENADOR
IF OBJECT_ID('SP_crearCompetir') IS NOT NULL
	BEGIN
		DROP PROC SP_crearCompetir
	END
GO

CREATE PROC SP_crearCompetir
@IDJUGADOR INT,
@IDCOMPETICION INT
as
BEGIN
	INSERT INTO COMPETIR([IDJUGADOR], [IDCOMPETICION])
	VALUES(@IDJUGADOR, @IDCOMPETICION)
END
GO

-------------------------------------------------------------- ENTRENA
-- VER ENTRENAMIENTOS
IF OBJECT_ID('SP_listarEntrenamientos') IS NOT NULL
	BEGIN
		DROP PROC SP_listarEntrenamientos
	END
GO

CREATE PROC SP_listarEntrenamientos
as
BEGIN
	SELECT EN.NOMBRE AS ENTRENADOR, J.NOMBRE AS JUGADOR
	FROM ENTRENA E, JUGADORES J, ENTRENADORES EN
	WHERE E.IDENTRENADOR = EN.IDENTRENADOR AND E.IDJUGADOR = J.IDJUGADOR
	ORDER BY EN.NOMBRE
END
GO
-- ASIGNAR ENTRENADOR
IF OBJECT_ID('SP_crearEntrenamiento') IS NOT NULL
	BEGIN
		DROP PROC SP_crearEntrenamiento
	END
GO

CREATE PROC SP_crearEntrenamiento
@IDENTRENADOR INT,
@IDJUGADOR INT
as
BEGIN
	INSERT INTO ENTRENA([IDENTRENADOR], [IDJUGADOR])
	VALUES(@IDENTRENADOR, @IDJUGADOR)
END
GO

------------------------------------------------------------------- COMPETICIONES
-- LISTAR
IF OBJECT_ID('SP_listarCompeticiones') IS NOT NULL
	BEGIN
		DROP PROC SP_listarCompeticiones
	END
GO

CREATE PROC SP_listarCompeticiones
as
BEGIN
	SELECT IDCOMPETICION AS ID
	,NOMBRE
	,FECHA
	,JUEGO
	FROM COMPETICIONES
END
GO

-- CREAR
IF OBJECT_ID('SP_crearCompeticion') IS NOT NULL
	BEGIN
		DROP PROC SP_crearCompeticion
	END
GO

CREATE PROC SP_crearCompeticion
@IDCOMPETICION INT,
@NOMBRE NVARCHAR(25),
@FECHA NVARCHAR(25),
@JUEGO NVARCHAR(25)
as
BEGIN
	INSERT INTO COMPETICIONES([IDCOMPETICION]
	,[NOMBRE], [FECHA], [JUEGO])
	VALUES(@IDCOMPETICION, @NOMBRE, @FECHA, @JUEGO)
END
GO
-- ACTUALIZAR
IF OBJECT_ID('SP_modificarCompeticion') IS NOT NULL
	BEGIN
		DROP PROC SP_modificarCompeticion
	END
GO

CREATE PROC SP_modificarCompeticion
@IDCOMPETICION INT,
@NOMBRE NVARCHAR(25),
@FECHA NVARCHAR(25),
@JUEGO NVARCHAR(25)
as
BEGIN
	UPDATE COMPETICIONES
	SET [NOMBRE] = @NOMBRE, [FECHA] = @FECHA, [JUEGO] = @JUEGO
	WHERE [IDCOMPETICION] = @IDCOMPETICION
END
GO
-- BORRAR
IF OBJECT_ID('SP_borrarCompeticion') IS NOT NULL
	BEGIN
		DROP PROC SP_borrarCompeticion
	END
GO

CREATE PROC SP_borrarCompeticion
@IDCOMPETICION INT
as
BEGIN
	DELETE FROM COMPETICIONES WHERE IDCOMPETICION = @IDCOMPETICION
END
GO

IF OBJECT_ID('SP_getUltCodigoAfiliado') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoAfiliado
	END
GO

CREATE PROC SP_getUltCodigoAfiliado
as
BEGIN
	SELECT
		TOP 1 IDAFILIADO
		FROM AFILIADOS
		ORDER BY IDAFILIADO DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoPatrocinio') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoPatrocinio
	END
GO

CREATE PROC SP_getUltCodigoPatrocinio
as
BEGIN
	SELECT
		TOP 1 IDPATROCINIO
		FROM PATROCINIOS
		ORDER BY IDPATROCINIO DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoTrofeos') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoTrofeos
	END
GO

CREATE PROC SP_getUltCodigoTrofeos
as
BEGIN
	SELECT
		TOP 1 IDTROFEO
		FROM TROFEOS
		ORDER BY IDTROFEO DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoProyectos') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoProyectos
	END
GO

CREATE PROC SP_getUltCodigoProyectos
as
BEGIN
	SELECT
		TOP 1 IDPROYECTO
		FROM PROYECTOS
		ORDER BY IDPROYECTO DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoEntrenadores') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoEntrenadores
	END
GO

CREATE PROC SP_getUltCodigoEntrenadores
as
BEGIN
	SELECT
		TOP 1 IDENTRENADOR
		FROM ENTRENADORES
		ORDER BY IDENTRENADOR DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoJugadores') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoJugadores
	END
GO

CREATE PROC SP_getUltCodigoJugadores
as
BEGIN
	SELECT
		TOP 1 IDJUGADOR
		FROM JUGADORES
		ORDER BY IDJUGADOR DESC
END
GO

IF OBJECT_ID('SP_getUltCodigoCompeticiones') IS NOT NULL
	BEGIN
		DROP PROC SP_getUltCodigoCompeticiones
	END
GO

CREATE PROC SP_getUltCodigoCompeticiones
as
BEGIN
	SELECT
		TOP 1 IDCOMPETICION
		FROM COMPETICIONES
		ORDER BY IDCOMPETICION DESC
END
GO